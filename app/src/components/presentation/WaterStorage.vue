<template>
  <ComponentBase
    component="water-storage"
    x="557"
    y="701"
    width="113"
    height="114"
    viewBox="-1 -1 113 114"
  >
    <rect
      width="111"
      height="112"
      rx="55.5"
      class="fill"
      fill="#86B4E8"
      stroke="white"
      stroke-width="1"
    />
    <circle
      cx="56"
      cy="56"
      r="46"
      class="fill"
      fill="#86B4E8"
    />
    <text
      fill="white"
      class="text"
      xml:space="preserve"
      style="white-space: pre"
      font-size="12"
      font-weight="bold"
      letter-spacing="0em"
    >
      <tspan
        x="26.4023"
        y="67.96"
      >
        Water tank
      </tspan>
    </text>
    <text
      class="text"
      fill="white"
      xml:space="preserve"
      style="white-space: pre"
      font-size="10"
      letter-spacing="0em"
    >
      <tspan
        x="58"
        y="83.3"
      >
        liter
      </tspan>
    </text>
    <text
      class="text"
      fill="white"
      xml:space="preserve"
      style="white-space: pre"
      font-family="DMMono"
      font-size="10"
      letter-spacing="0em"
    >
      <AnimatedNumber
        tag="tspan"
        text-anchor="end"
        x="54"
        y="83.3"
        :to="value"
        :format="formattedInt"
      />
    </text>
    <path
      class="text"
      d="M45.0018 43.6666C45.005 38.6359 45.0058 33.2777 45.0018 26.293C45.0018 26.166 44.982 26.0926 44.9662 26.0546C44.5947 25.1894 44.7389 24.3497 45.3708 23.6915C45.7644 23.2815 46.2491 22.9079 46.7718 22.6117C47.9937 21.9189 49.3471 21.6071 50.3909 21.4132C51.8638 21.1394 53.3693 21 54.8653 21C56.1371 21 57.4343 21.1006 58.7211 21.2986C60.4167 21.5601 61.7447 21.9568 62.9002 22.5474C63.6438 22.9276 64.1435 23.3194 64.5189 23.816C65.0154 24.4734 65.1286 25.1885 64.8538 25.9408C64.8 26.0884 64.7699 26.246 64.7699 26.3846C64.7659 30.7966 64.7659 35.2087 64.7651 39.6208V43.3787C64.7643 43.6757 64.7636 43.9314 64.8839 44.1722C64.9702 44.3479 64.9837 44.545 64.9908 44.7488C65.0265 45.7312 64.4515 46.3424 63.9463 46.7647C63.3769 47.2414 62.7053 47.6019 61.7693 47.9351C59.7705 48.6461 57.6227 48.9546 54.3576 49H54.3473H54.337C54.1787 48.9868 53.9838 48.9728 53.7621 48.9563C53.1389 48.9109 52.2844 48.8491 51.4402 48.746C49.7312 48.5364 48.2867 48.1364 47.0236 47.5219C46.3861 47.2118 45.667 46.7944 45.1633 46.0504C44.7238 45.4029 44.6502 44.71 44.944 43.9916C44.9804 43.9025 45.001 43.787 45.001 43.6674L45.0018 43.6666ZM54.9254 47.6143C56.7168 47.6143 58.5081 47.3957 60.2504 46.9651C61.3535 46.6929 62.1447 46.3646 62.8154 45.9011C63.0609 45.732 63.3064 45.5027 63.5274 45.2363C63.7079 45.0185 63.7238 44.7686 63.5757 44.4716C63.4917 44.3042 63.4426 44.0963 63.441 43.9017C63.4339 43.203 63.4347 42.5118 63.4355 41.781C63.4355 41.6738 63.4355 41.5665 63.4355 41.4585C62.7972 41.8561 62.0813 42.1728 61.2157 42.4434C59.8417 42.8731 58.3173 43.1387 56.5552 43.255C55.9732 43.2929 55.3903 43.3127 54.8225 43.3127C53.4342 43.3127 52.0658 43.1964 50.7536 42.9663C49.3685 42.7238 47.7727 42.3543 46.3314 41.4593V42.8673C46.3314 42.9539 46.333 43.0397 46.3354 43.1263C46.3394 43.3309 46.3441 43.542 46.3251 43.7548C46.3021 44.0188 46.2443 44.286 46.1596 44.5285C46.0099 44.955 46.1636 45.1323 46.2134 45.1909C46.4043 45.4111 46.6965 45.7287 47.0291 45.9473C48.0666 46.6302 49.237 46.9305 50.1406 47.1161C51.7474 47.446 53.3566 47.6143 54.9246 47.6143H54.9254ZM48.7611 36.1836C48.8949 36.2835 49.0628 36.3387 49.2331 36.3387C49.4033 36.3387 49.5641 36.2876 49.6987 36.1894C49.9838 35.9832 50.101 35.6582 50.0194 35.2994C49.8967 34.7542 49.5863 34.3055 49.2457 33.8428C48.8775 34.3311 48.6019 34.7814 48.4491 35.2961C48.354 35.617 48.4791 35.9741 48.7611 36.1845V36.1836ZM52.7872 37.642C53.0581 38.2614 53.5602 38.7192 54.2 38.9328C54.4241 39.0071 54.6554 39.045 54.8874 39.045C55.9613 39.045 56.8863 38.268 57.1365 37.1561C57.2846 36.4971 57.1024 35.89 56.8831 35.3324C56.56 34.51 55.5867 33.0113 54.8819 32.2261C54.794 32.3473 54.7061 32.4677 54.6198 32.5849C54.3054 33.013 54.0084 33.418 53.7439 33.8502C53.3519 34.4911 53.0272 35.1188 52.7793 35.7176C52.518 36.3486 52.5211 37.0324 52.788 37.642H52.7872ZM60.0397 36.1853C60.1743 36.2843 60.3414 36.3387 60.5117 36.3387C60.682 36.3387 60.8285 36.2909 60.9591 36.201C61.2624 35.9906 61.3955 35.6458 61.306 35.3019C61.1619 34.7476 60.853 34.2758 60.522 33.8436C60.191 34.2997 59.8885 34.741 59.7435 35.2689C59.6437 35.6327 59.7546 35.975 60.0397 36.1853ZM63.4347 34.6593V34.2981C63.4347 34.2981 62.775 34.6668 62.5485 34.793C62.7782 36.3395 62.2333 37.3549 61.0035 37.6618C60.819 37.7079 60.636 37.731 60.461 37.731C59.5851 37.731 58.878 37.1471 58.4812 36.1144C58.6301 37.4366 58.2436 38.5518 57.3281 39.4335C56.6479 40.0893 55.8259 40.4217 54.8851 40.4217C54.8154 40.4217 54.7441 40.42 54.6728 40.4159C53.6283 40.3615 52.6186 39.7948 51.9723 38.8982C51.4109 38.1187 51.1709 37.1685 51.277 36.1779C51.0656 36.8295 50.6546 37.2922 50.0495 37.5562C49.7874 37.67 49.5166 37.7277 49.2442 37.7277C48.9994 37.7277 48.7508 37.6807 48.5053 37.5892C47.4069 37.1776 46.9309 36.1399 47.2113 34.793L46.3338 34.2989C46.3338 34.7319 46.3338 35.165 46.3338 35.5972C46.3338 36.8798 46.3354 38.2062 46.3267 39.5102C46.3259 39.6645 46.3702 39.7602 46.4977 39.8773C47.1305 40.4588 47.8907 40.7698 48.6185 41.0189C49.9933 41.4898 51.5067 41.7637 53.382 41.8792C53.9086 41.9122 54.4352 41.9287 54.9484 41.9287C56.5045 41.9287 58.029 41.7752 59.4806 41.4733C60.3557 41.2919 61.3789 41.0345 62.3347 40.5091C62.6491 40.3367 62.9477 40.1 63.2367 39.8707L63.3721 39.7643C63.3943 39.7461 63.4292 39.6719 63.4292 39.6315C63.4371 37.9744 63.4355 36.2892 63.4339 34.6593H63.4347ZM46.3378 32.396C46.3378 32.4793 46.3671 32.5684 46.3932 32.5972C46.8034 33.046 47.3253 33.3256 47.8044 33.5351C47.867 33.451 47.9288 33.3676 47.9897 33.2843C48.2036 32.9948 48.4055 32.7218 48.6209 32.4496C48.7492 32.2871 48.9519 32.0718 49.2299 32.0718C49.5079 32.0718 49.6987 32.2706 49.827 32.4199C50.4376 33.126 50.8573 33.7619 51.1464 34.4193C51.1582 34.4391 51.2026 34.4713 51.2256 34.4762C51.4212 34.5158 51.5748 34.548 51.6714 34.548C51.7744 34.548 51.7973 34.5307 52.0357 34.0869L52.0412 34.0762C52.6146 33.0105 53.3638 31.9374 54.3331 30.795C54.5041 30.5937 54.6894 30.4914 54.8843 30.4914C55.0791 30.4914 55.2541 30.5879 55.422 30.7776C56.5924 32.0974 57.4002 33.2761 57.9633 34.4886C57.987 34.5397 58.0013 34.5513 58.0013 34.5513C58.0021 34.5513 58.0163 34.5579 58.0702 34.5579C58.0829 34.5579 58.0963 34.5579 58.1106 34.5571C58.4535 34.5439 58.6325 34.4177 58.8201 34.0564C59.0807 33.5524 59.4244 33.0963 59.757 32.655C59.8259 32.5642 59.894 32.4727 59.9613 32.382C60.1522 32.1238 60.3628 32.0693 60.5054 32.0693C60.6479 32.0693 60.8546 32.1221 61.0613 32.3721C61.3036 32.6665 61.5309 32.961 61.7717 33.2736C61.8374 33.3594 61.9039 33.4452 61.9704 33.5318C62.4305 33.3297 62.9342 33.0608 63.3476 32.6327C63.3967 32.5816 63.43 32.5082 63.4307 32.4801C63.4379 30.9302 63.4363 29.354 63.4347 27.8288V27.4857C63.3333 27.5484 63.2296 27.6111 63.1235 27.6697C62.0164 28.2784 60.7738 28.685 59.2121 28.9498C57.6956 29.2072 56.2012 29.3375 54.7718 29.3375C52.6922 29.3375 50.6577 29.0612 48.7246 28.5159C47.7973 28.2545 47.0268 27.9212 46.333 27.4799V29.9099C46.3322 30.7249 46.3314 31.567 46.3386 32.396H46.3378ZM46.3782 25.7511C46.706 26.0695 47.1028 26.354 47.5257 26.5743C48.6082 27.1368 49.8611 27.4948 51.4679 27.6985C52.2551 27.7992 53.062 27.8618 53.8437 27.9221C54.1921 27.9493 54.5414 27.9765 54.889 28.0062C56.7215 27.9385 58.8811 27.7752 61.0122 27.0832C61.8912 26.797 62.5176 26.491 63.0435 26.0909C63.0926 26.0538 63.1385 26.0167 63.1837 25.9763C63.5091 25.6917 63.6731 25.4187 63.6723 25.163C63.6715 24.9106 63.5091 24.6433 63.1892 24.3686C62.425 23.7121 61.4794 23.3797 60.6558 23.1405C58.9104 22.6357 57.0597 22.3899 54.9975 22.3899C54.5659 22.3899 54.1185 22.4006 53.6663 22.4228C51.513 22.5276 49.907 22.8188 48.457 23.3681C47.9984 23.5422 47.5502 23.797 47.117 24.0437C46.9642 24.1311 46.8113 24.2177 46.6577 24.3018C46.5761 24.3464 46.4938 24.4388 46.4138 24.5287L46.3861 24.5592C46.1913 24.7761 46.0915 24.984 46.0891 25.177C46.0867 25.3684 46.1841 25.5614 46.3782 25.7503V25.7511Z"
      fill="white"
    />
  </ComponentBase>
</template>

<script setup lang="ts">
import AnimatedNumber from "vue-number-animation";
import { useObservable } from "@vueuse/rxjs";
import ComponentBase from "./ComponentBase.vue";
import { type PowerHubStore } from "@/stores/power-hub";
import { formattedInt } from "@/utils/numbers";
import { map } from "rxjs";

const { powerHub } = defineProps<{ powerHub: PowerHubStore }>();

const value = useObservable(
  powerHub.sensors.useMqtt("fresh_water_tank/fill").pipe(map(({ value }) => value)),
);
</script>
