<template>
  <svg
    width="442"
    height="260"
    viewBox="0 0 442 260"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-size="20"
      font-weight="600"
      letter-spacing="0em"
    >
      <tspan
        x="365.736"
        y="110.6"
      >
        <AnimatedNumber
          :to="outdoorTemperature"
          :format="formattedInt"
          tag="tspan"
        />
        <tspan
          width="30"
          text-anchor="end"
        >
          &#8451;
        </tspan>
      </tspan>
    </text>
    <text
      fill="#5A5A5A"
      xml:space="preserve"
      style="white-space: pre"
      font-size="14"
      font-weight="600"
      letter-spacing="0em"
    >
      <tspan
        x="365.736"
        y="131.62"
      >
        Outdoor
      </tspan>
    </text>
    <g clip-path="url(#clip0_910_2841)">
      <path
        d="M352.772 108.853C352.772 112.859 352.783 116.868 352.761 120.874C352.757 121.499 352.917 121.936 353.395 122.38C357.06 125.795 357.245 131.435 353.851 135.088C350.452 138.745 344.764 138.984 341.028 135.632C337.296 132.276 336.963 126.683 340.313 122.945C340.783 122.42 340.965 121.921 340.965 121.234C340.946 113.218 340.946 105.206 340.958 97.1907C340.961 94.1688 342.699 91.8482 345.405 91.1799C349.192 90.2472 352.724 92.9718 352.761 96.919C352.802 100.896 352.768 104.872 352.772 108.849V108.853ZM350.878 109.297H350.875C350.875 105.137 350.901 100.976 350.864 96.8162C350.841 94.1431 348.318 92.3145 345.742 93.0378C343.982 93.5335 342.866 95.0647 342.862 97.0585C342.855 105.379 342.851 113.699 342.87 122.02C342.87 122.747 342.662 123.272 342.125 123.786C339.09 126.691 339.153 131.28 342.229 134.159C345.212 136.953 349.818 136.737 352.568 133.678C355.292 130.645 354.918 125.967 351.694 123.39C351.064 122.887 350.86 122.354 350.864 121.59C350.889 117.493 350.875 113.391 350.875 109.293L350.878 109.297Z"
        fill="#646464"
      />
      <path
        d="M348.999 118.178C348.999 120.256 349.036 120.771 348.981 122.85C348.962 123.555 349.192 123.966 349.781 124.322C351.126 125.137 352.038 126.29 352.36 127.854C352.883 130.366 351.571 132.848 349.188 133.832C346.79 134.82 344.07 133.953 342.632 131.736C341.254 129.617 341.506 126.779 343.477 125.152C344.541 124.274 344.789 123.364 344.767 122.101C344.704 118.128 344.719 120.13 344.722 116.157C344.724 114.693 344.767 114.064 347.139 114.064C349.75 114.064 349.018 115.373 349.003 118.267C348.995 119.978 348.981 114.094 348.981 115.805L348.999 118.178Z"
        fill="#646464"
      />
      <path
        d="M346.824 109.963C346.423 109.963 345.956 110.091 345.645 109.93C345.278 109.739 344.863 109.32 344.815 108.957C344.782 108.718 345.334 108.208 345.675 108.153C346.453 108.031 347.283 108.02 348.054 108.153C348.406 108.215 348.873 108.711 348.921 109.056C348.958 109.317 348.454 109.776 348.095 109.923C347.728 110.073 347.25 109.956 346.82 109.956L346.824 109.963Z"
        fill="#646464"
      />
      <path
        d="M346.798 113.027C346.397 113.027 345.945 113.144 345.615 112.994C345.263 112.832 344.844 112.443 344.807 112.109C344.774 111.837 345.226 111.283 345.515 111.242C346.39 111.125 347.302 111.114 348.172 111.239C348.484 111.283 348.936 111.844 348.925 112.16C348.914 112.458 348.432 112.858 348.072 112.997C347.702 113.144 347.227 113.03 346.798 113.03C346.798 113.03 346.798 113.03 346.798 113.027Z"
        fill="#646464"
      />
    </g>
    <text
      fill="#5A5A5A"
      xml:space="preserve"
      style="white-space: pre"
      font-size="18"
      font-weight="600"
      letter-spacing="0em"
    >
      <tspan
        x="84.3223"
        y="173.94"
      >
        Compound
      </tspan>
    </text>
    <text
      fill="#5A5A5A"
      xml:space="preserve"
      style="white-space: pre"
      font-size="18"
      font-weight="600"
      letter-spacing="0em"
    >
      <tspan
        x="78.7324"
        y="193.94"
      >
        temperature
      </tspan>
    </text>
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-size="80"
      font-family="Five-Gothic-Bold"
      letter-spacing="0em"
    >
      <tspan
        text-anchor="end"
        x="158"
        y="142.4"
      >
        <AnimatedNumber
          :to="compundTemperature"
          :format="formattedInt"
          tag="tspan"
        />
      </tspan>
    </text>
    <circle
      cx="130"
      cy="130"
      r="104"
      stroke="#AEE8EB"
      stroke-width="8"
    />
    <circle
      cx="130"
      cy="130"
      r="129"
      stroke="#E0E0E0"
      stroke-width="2"
    />
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-size="25"
      font-family="Five-Gothic-Bold"
      letter-spacing="0em"
    >
      <tspan
        x="166.845"
        y="108.25"
      >
        C
      </tspan>
    </text>
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-size="15"
      font-family="Five-Gothic-Bold"
      letter-spacing="0em"
    >
      <tspan
        x="159.149"
        y="96.95"
      >
        o
      </tspan>
    </text>
    <path
      d="M185.302 131.129L183.927 130.336L184.985 130.051C185.318 129.961 185.518 129.616 185.428 129.282L185.265 128.676C185.176 128.342 184.83 128.143 184.496 128.232L181.615 129.005L179.015 127.5L181.611 125.998L184.492 126.771C184.826 126.861 185.172 126.661 185.261 126.328L185.424 125.722C185.514 125.388 185.314 125.042 184.981 124.952L183.923 124.668L185.298 123.874C185.599 123.699 185.701 123.317 185.53 123.016L184.899 121.925C184.724 121.624 184.342 121.522 184.041 121.693L182.665 122.487L182.95 121.429C183.04 121.095 182.84 120.749 182.507 120.66L181.9 120.497C181.567 120.407 181.221 120.607 181.131 120.94L180.358 123.821L177.803 125.294V122.141L179.988 119.956C180.24 119.703 180.24 119.288 179.988 119.036L179.528 118.576C179.276 118.324 178.861 118.324 178.608 118.576L177.803 119.378V117.734C177.803 117.376 177.51 117.083 177.152 117.083H175.85C175.492 117.083 175.199 117.376 175.199 117.734V119.378L174.397 118.576C174.145 118.324 173.73 118.324 173.477 118.576L173.014 119.036C172.757 119.288 172.757 119.703 173.014 119.956L175.199 122.141V125.294L172.643 123.821L171.87 120.94C171.781 120.607 171.435 120.407 171.101 120.497L170.495 120.66C170.161 120.749 169.962 121.095 170.051 121.429L170.336 122.487L168.961 121.693C168.66 121.518 168.277 121.624 168.102 121.925L167.472 123.012C167.297 123.313 167.402 123.695 167.704 123.87L169.079 124.664L168.021 124.948C167.683 125.038 167.484 125.384 167.573 125.722L167.736 126.328C167.826 126.661 168.171 126.861 168.505 126.771L171.386 125.998L173.982 127.5L171.386 129.001L168.505 128.228C168.171 128.139 167.826 128.338 167.736 128.672L167.573 129.278C167.484 129.611 167.683 129.957 168.017 130.047L169.075 130.332L167.699 131.129C167.398 131.304 167.297 131.687 167.468 131.988L168.098 133.078C168.273 133.379 168.656 133.481 168.957 133.31L170.332 132.517L170.047 133.575C169.958 133.908 170.157 134.254 170.491 134.344L171.097 134.507C171.431 134.596 171.777 134.397 171.866 134.063L172.639 131.182L175.195 129.709V132.863L173.01 135.048C172.753 135.3 172.753 135.715 173.01 135.967L173.469 136.427C173.722 136.679 174.137 136.679 174.389 136.427L175.191 135.625V137.265C175.191 137.623 175.483 137.916 175.842 137.916H177.144C177.502 137.916 177.795 137.623 177.795 137.265V135.621L178.596 136.423C178.849 136.675 179.264 136.675 179.516 136.423L179.976 135.963C180.228 135.711 180.228 135.296 179.976 135.044L177.803 132.859V129.705L180.358 131.178L181.131 134.059C181.221 134.393 181.567 134.592 181.9 134.502L182.507 134.34C182.84 134.25 183.04 133.904 182.95 133.571L182.665 132.513L184.041 133.306C184.342 133.481 184.724 133.375 184.899 133.074L185.53 131.984C185.705 131.687 185.603 131.3 185.302 131.129V131.129Z"
      fill="#747474"
    />
    <path
      d="M301 -4.2092e-08L300 253"
      stroke="#9A9A9A"
      stroke-dasharray="5 5"
    />
    <defs>
      <clipPath id="clip0_910_2841">
        <rect
          width="18.2778"
          height="47"
          fill="white"
          transform="translate(338 91)"
        />
      </clipPath>
    </defs>
  </svg>
</template>

<script setup lang="ts">
import { usePowerHubStore } from "@/stores/power-hub";
import { useLastOrNone } from "@/utils";
import { formattedInt } from "@/utils/numbers";
import { useObservable } from "@vueuse/rxjs";
import { map } from "rxjs";
import AnimatedNumber from "vue-number-animation";

const { sensors, weather } = usePowerHubStore();

const compundTemperature = useObservable(
  sensors.useLastValues("compound/overall_temperature").pipe(map(useLastOrNone)),
);
const outdoorTemperature = useObservable(weather.current().pipe(map((val) => val.temp)));
</script>
