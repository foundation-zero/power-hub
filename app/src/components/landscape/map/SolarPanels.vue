<template>
  <ComponentBase
    component="solar-panels"
    journey="electrical"
    width="114"
    height="114"
    viewBox="-1 -1 114 114"
  >
    <rect
      width="111.669"
      height="111.669"
      rx="55.8343"
      fill="#FFFFFE"
      stroke="#E6E6E6"
      stroke-width="1"
    />
    <circle
      cx="55.6488"
      cy="56"
      r="46"
      class="fill"
      fill="#FFEFB9"
    />
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-size="12"
      font-family="Five-Gothic-Bold"
      letter-spacing="0em"
    >
      <tspan
        x="26.5352"
        y="66.96"
      >
        PV Panels
      </tspan>
    </text>
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-size="9"
      letter-spacing="0em"
    >
      <tspan
        x="58"
        y="81.91"
        >{{ unit }}</tspan
      >
    </text>
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-family="DMMono"
      font-size="10"
      letter-spacing="0em"
    >
      <AnimatedNumber
        x="56"
        y="81.91"
        text-anchor="end"
        tag="tspan"
        :to="value"
        :format="formattedInt"
      />
    </text>
    <path
      d="M58.6688 46.1562H54.7938C54.4371 46.1562 54.1479 46.4454 54.1479 46.8021V50.3542C54.1479 50.7109 54.4371 51 54.7938 51H58.6688C59.0255 51 59.3146 50.7109 59.3146 50.3542V46.8021C59.3146 46.4454 59.0255 46.1562 58.6688 46.1562Z"
      fill="#756B61"
    />
    <path
      d="M57.3773 37.1146V39.0521C57.3773 39.2234 57.4454 39.3876 57.5665 39.5088C57.6876 39.6299 57.8519 39.6979 58.0232 39.6979H67.969C68.0251 39.6977 68.0802 39.683 68.1288 39.655C68.1775 39.6271 68.218 39.587 68.2464 39.5386C68.2748 39.4902 68.2902 39.4353 68.2909 39.3792C68.2916 39.3231 68.2777 39.2678 68.2506 39.2187L66.9085 36.8007C66.8525 36.6999 66.7704 36.6159 66.6709 36.5576C66.5714 36.4992 66.4581 36.4685 66.3428 36.4688H58.0232C57.8519 36.4688 57.6876 36.5368 57.5665 36.6579C57.4454 36.779 57.3773 36.9433 57.3773 37.1146Z"
      fill="#756B61"
    />
    <path
      d="M55.4398 36.4688H47.1163C47.0011 36.4687 46.8881 36.4995 46.7888 36.5579C46.6896 36.6163 46.6078 36.7001 46.5518 36.8007L45.2033 39.2187C45.1761 39.2679 45.1622 39.3233 45.163 39.3795C45.1638 39.4357 45.1792 39.4907 45.2078 39.5392C45.2364 39.5876 45.2771 39.6277 45.3259 39.6555C45.3747 39.6833 45.43 39.698 45.4862 39.6979H55.432C55.6033 39.6979 55.7676 39.6299 55.8887 39.5088C56.0098 39.3876 56.0779 39.2234 56.0779 39.0521V37.1146C56.0779 36.9446 56.0109 36.7815 55.8914 36.6606C55.772 36.5397 55.6097 36.4708 55.4398 36.4688Z"
      fill="#756B61"
    />
    <path
      d="M57.3773 32.5941V34.5316C57.3773 34.7029 57.4454 34.8671 57.5665 34.9883C57.6876 35.1094 57.8519 35.1774 58.0232 35.1774H65.4606C65.5168 35.1775 65.572 35.1628 65.6208 35.135C65.6697 35.1072 65.7104 35.067 65.739 35.0186C65.7675 34.9702 65.783 34.9152 65.7838 34.859C65.7845 34.8028 65.7706 34.7474 65.7434 34.6982L64.5809 32.6122C64.469 32.4109 64.3054 32.2432 64.1069 32.1265C63.9084 32.0098 63.6823 31.9482 63.452 31.9482H58.0232C57.8519 31.9482 57.6876 32.0163 57.5665 32.1374C57.4454 32.2585 57.3773 32.4228 57.3773 32.5941Z"
      fill="#756B61"
    />
    <path
      d="M56.0854 32.5941C56.0854 32.4228 56.0174 32.2585 55.8962 32.1374C55.7751 32.0163 55.6108 31.9482 55.4396 31.9482H50.0068C49.7764 31.9484 49.5502 32.0101 49.3517 32.1271C49.1532 32.244 48.9896 32.412 48.8779 32.6135L47.7154 34.6982C47.6882 34.7473 47.6743 34.8026 47.6751 34.8587C47.6758 34.9148 47.6911 34.9697 47.7196 35.0181C47.748 35.0665 47.7885 35.1066 47.8371 35.1345C47.8858 35.1625 47.9409 35.1772 47.997 35.1774H55.4344C55.6057 35.1774 55.7699 35.1094 55.8911 34.9883C56.0122 34.8671 56.0802 34.7029 56.0802 34.5316L56.0854 32.5941Z"
      fill="#756B61"
    />
    <path
      d="M70.325 42.9461L69.4208 41.3212C69.3649 41.2206 69.283 41.1368 69.1838 41.0784C69.0845 41.02 68.9715 40.9893 68.8564 40.9893H58.0232C57.8519 40.9893 57.6876 41.0573 57.5665 41.1784C57.4454 41.2995 57.3773 41.4638 57.3773 41.6351V44.2184C57.3773 44.3897 57.4454 44.554 57.5665 44.6751C57.6876 44.7962 57.8519 44.8643 58.0232 44.8643H69.1961C69.4209 44.8641 69.6417 44.8054 69.8368 44.6937C70.032 44.5821 70.1946 44.4215 70.3086 44.2278C70.4226 44.034 70.4841 43.8139 70.487 43.5891C70.4898 43.3643 70.434 43.1427 70.325 42.9461Z"
      fill="#756B61"
    />
    <path
      d="M56.0852 44.2184V41.6351C56.0852 41.4638 56.0172 41.2995 55.8961 41.1784C55.775 41.0573 55.6107 40.9893 55.4394 40.9893H44.6036C44.4885 40.9893 44.3754 41.02 44.2762 41.0784C44.1769 41.1368 44.0951 41.2206 44.0392 41.3212L43.135 42.9461C43.0259 43.1428 42.9701 43.3646 42.973 43.5894C42.9759 43.8143 43.0375 44.0345 43.1517 44.2283C43.2659 44.4221 43.4287 44.5827 43.624 44.6942C43.8193 44.8058 44.0403 44.8644 44.2652 44.8643H55.4381C55.523 44.8644 55.6071 44.8479 55.6857 44.8155C55.7642 44.7831 55.8355 44.7355 55.8956 44.6756C55.9557 44.6156 56.0034 44.5443 56.0359 44.4659C56.0685 44.3874 56.0852 44.3033 56.0852 44.2184Z"
      fill="#756B61"
    />
    <path
      d="M45.5663 31.594C45.6497 31.6935 45.7523 31.7751 45.8679 31.8342C45.9836 31.8932 46.1099 31.9284 46.2394 31.9376C46.3689 31.9469 46.4989 31.93 46.6218 31.888C46.7446 31.846 46.8578 31.7797 46.9545 31.6931C47.0513 31.6065 47.1296 31.5013 47.1849 31.3839C47.2402 31.2664 47.2713 31.139 47.2764 31.0093C47.2814 30.8795 47.2604 30.7501 47.2145 30.6287C47.1686 30.5072 47.0987 30.3963 47.009 30.3024C46.695 29.9512 46.471 29.529 46.3563 29.0721C46.2416 28.6151 46.2398 28.1372 46.3509 27.6794C46.462 27.2216 46.6827 26.7976 46.9941 26.4441C47.3054 26.0905 47.6981 25.8179 48.1381 25.6498C48.5782 25.4817 49.0526 25.4231 49.5204 25.4791C49.9881 25.5351 50.4353 25.7039 50.8233 25.971C51.2113 26.2382 51.5286 26.5957 51.7477 27.0127C51.9669 27.4297 52.0814 27.8937 52.0814 28.3649C52.0814 28.6218 52.1835 28.8682 52.3652 29.0499C52.5468 29.2315 52.7932 29.3336 53.0502 29.3336C53.3071 29.3336 53.5535 29.2315 53.7352 29.0499C53.9169 28.8682 54.0189 28.6218 54.0189 28.3649C54.0192 27.5795 53.8285 26.8059 53.4633 26.1107C53.0981 25.4155 52.5693 24.8195 51.9225 24.3741C51.2758 23.9286 50.5304 23.6471 49.7507 23.5538C48.9709 23.4605 48.1802 23.5582 47.4466 23.8385C46.713 24.1187 46.0585 24.5732 45.5396 25.1626C45.0207 25.752 44.6528 26.4588 44.4678 27.222C44.2828 27.9852 44.2861 28.7819 44.4774 29.5436C44.6688 30.3052 45.0425 31.0089 45.5663 31.594Z"
      fill="#756B61"
    />
    <path
      d="M49.1752 22.2292C49.4321 22.2292 49.6785 22.1271 49.8602 21.9454C50.0419 21.7638 50.1439 21.5173 50.1439 21.2604V19.9688C50.1439 19.7118 50.0419 19.4654 49.8602 19.2837C49.6785 19.1021 49.4321 19 49.1752 19C48.9182 19 48.6718 19.1021 48.4902 19.2837C48.3085 19.4654 48.2064 19.7118 48.2064 19.9688V21.2604C48.2064 21.5173 48.3085 21.7638 48.4902 21.9454C48.6718 22.1271 48.9182 22.2292 49.1752 22.2292Z"
      fill="#756B61"
    />
    <path
      d="M54.8909 24.0257L55.8041 23.1125C55.8966 23.0231 55.9703 22.9162 56.021 22.798C56.0717 22.6797 56.0984 22.5526 56.0995 22.424C56.1005 22.2953 56.0759 22.1678 56.0272 22.0488C55.9784 21.9297 55.9064 21.8216 55.8154 21.7307C55.7244 21.6398 55.6162 21.5679 55.4972 21.5192C55.3781 21.4706 55.2505 21.4461 55.1219 21.4473C54.9932 21.4485 54.8661 21.4753 54.748 21.5261C54.6298 21.5769 54.5229 21.6508 54.4336 21.7433L53.5204 22.6565C53.344 22.8393 53.2465 23.0841 53.2488 23.3381C53.2511 23.5921 53.3531 23.835 53.5328 24.0146C53.7125 24.1941 53.9556 24.2959 54.2096 24.2979C54.4636 24.3 54.7082 24.2023 54.8909 24.0257Z"
      fill="#756B61"
    />
    <path
      d="M55.3102 28.3643C55.3102 28.6212 55.4122 28.8676 55.5939 29.0493C55.7756 29.2309 56.022 29.333 56.2789 29.333H57.5706C57.8275 29.333 58.0739 29.2309 58.2556 29.0493C58.4373 28.8676 58.5393 28.6212 58.5393 28.3643C58.5393 28.1073 58.4373 27.8609 58.2556 27.6792C58.0739 27.4976 57.8275 27.3955 57.5706 27.3955H56.2789C56.022 27.3955 55.7756 27.4976 55.5939 27.6792C55.4122 27.8609 55.3102 28.1073 55.3102 28.3643Z"
      fill="#756B61"
    />
    <path
      d="M43.4669 24.0263C43.6505 24.1974 43.8934 24.2905 44.1444 24.2861C44.3954 24.2817 44.6348 24.18 44.8123 24.0025C44.9898 23.825 45.0915 23.5856 45.0959 23.3346C45.1003 23.0836 45.0072 22.8407 44.8361 22.6571L43.9229 21.7439C43.8342 21.6487 43.7272 21.5724 43.6084 21.5194C43.4896 21.4665 43.3613 21.438 43.2312 21.4357C43.1011 21.4334 42.9719 21.4573 42.8513 21.5061C42.7307 21.5548 42.6211 21.6273 42.5291 21.7193C42.4371 21.8113 42.3646 21.9209 42.3159 22.0415C42.2671 22.1621 42.2432 22.2913 42.2455 22.4214C42.2478 22.5515 42.2763 22.6797 42.3292 22.7986C42.3822 22.9174 42.4585 23.0244 42.5537 23.113L43.4669 24.0263Z"
      fill="#756B61"
    />
    <path
      d="M43.9229 34.9862L44.8361 34.073C44.9312 33.9843 45.0076 33.8774 45.0605 33.7585C45.1135 33.6397 45.142 33.5114 45.1442 33.3813C45.1465 33.2513 45.1226 33.1221 45.0739 33.0014C45.0252 32.8808 44.9526 32.7712 44.8607 32.6792C44.7687 32.5873 44.6591 32.5147 44.5385 32.466C44.4178 32.4173 44.2886 32.3934 44.1586 32.3957C44.0285 32.398 43.9002 32.4264 43.7814 32.4794C43.6625 32.5323 43.5556 32.6087 43.4669 32.7038L42.5537 33.617C42.4585 33.7057 42.3822 33.8127 42.3292 33.9315C42.2763 34.0504 42.2478 34.1786 42.2455 34.3087C42.2432 34.4388 42.2671 34.568 42.3159 34.6886C42.3646 34.8092 42.4371 34.9188 42.5291 35.0108C42.6211 35.1028 42.7307 35.1753 42.8513 35.224C42.9719 35.2728 43.1011 35.2967 43.2312 35.2944C43.3613 35.2921 43.4896 35.2636 43.6084 35.2107C43.7272 35.1577 43.8342 35.0814 43.9229 34.9862Z"
      fill="#756B61"
    />
    <path
      d="M43.0393 28.3643C43.0393 28.1073 42.9373 27.8609 42.7556 27.6792C42.5739 27.4976 42.3275 27.3955 42.0706 27.3955H40.7789C40.522 27.3955 40.2756 27.4976 40.0939 27.6792C39.9122 27.8609 39.8102 28.1073 39.8102 28.3643C39.8102 28.6212 39.9122 28.8676 40.0939 29.0493C40.2756 29.2309 40.522 29.333 40.7789 29.333H42.0706C42.3275 29.333 42.5739 29.2309 42.7556 29.0493C42.9373 28.8676 43.0393 28.6212 43.0393 28.3643Z"
      fill="#756B61"
    />
  </ComponentBase>
</template>

<script setup lang="ts">
import AnimatedNumber from "vue-number-animation";
import { formattedInt } from "@/utils/numbers";
import { useObservable } from "@vueuse/rxjs";
import ComponentBase from "./ComponentBase.vue";
import { type PowerHubStore } from "@/stores/power-hub";

import { useAsWatts } from "@/utils";

const { powerHub } = defineProps<{ powerHub: PowerHubStore }>();

const { value, unit } = useAsWatts(useObservable(powerHub.sensors.useMean("pv_panel/power")));
</script>
