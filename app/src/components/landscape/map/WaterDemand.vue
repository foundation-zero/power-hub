<template>
  <ComponentBase
    component="water-demand"
    journey="water"
    width="113"
    height="114"
    viewBox="-1 -1 113 114"
  >
    <rect
      x="1"
      width="110"
      height="111"
      rx="55"
      fill="#FDFEFF"
      stroke="#E6E6E6"
      stroke-width="1"
    />
    <circle
      cx="56.0001"
      cy="56"
      r="44"
      fill="white"
      class="fill"
      stroke="#86B4E8"
      stroke-width="4"
    />
    <text
      fill="#6C6C6C"
      xml:space="preserve"
      style="white-space: pre"
      font-size="12"
      font-family="Five-Gothic-Bold"
      letter-spacing="0em"
    >
      <tspan
        x="38.9434"
        y="59.96"
      >
        Water
      </tspan>
    </text>
    <text
      fill="#6C6C6C"
      xml:space="preserve"
      style="white-space: pre"
      font-size="12"
      font-family="Five-Gothic-Bold"
      letter-spacing="0em"
    >
      <tspan
        x="33.043"
        y="71.96"
      >
        demand
      </tspan>
    </text>
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-family="DMMono"
      font-size="10"
      letter-spacing="0em"
    >
      <AnimatedNumber
        tag="tspan"
        text-anchor="end"
        x="54"
        y="84.8"
        :to="value"
        :format="formattedInt"
      />
    </text>
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-size="9"
      letter-spacing="0em"
    >
      <tspan
        x="58"
        y="84.8"
      >
        l/min
      </tspan>
    </text>
    <g clip-path="url(#clip0_518_1814)">
      <path
        d="M66.3984 44.6699C66.1997 44.67 66.0047 44.7233 65.8337 44.8245C65.6627 44.9256 65.5219 45.0708 65.4262 45.2448C64.1598 47.5512 64.1598 48.1882 64.1598 48.398C64.1532 48.6963 64.2062 48.9928 64.3157 49.2703C64.4253 49.5478 64.5891 49.8006 64.7977 50.0139C65.0063 50.2272 65.2554 50.3966 65.5304 50.5123C65.8053 50.628 66.1007 50.6876 66.399 50.6876C66.6973 50.6876 66.9926 50.628 67.2676 50.5123C67.5426 50.3966 67.7917 50.2272 68.0002 50.0139C68.2088 49.8006 68.3727 49.5478 68.4822 49.2703C68.5918 48.9928 68.6448 48.6963 68.6382 48.398C68.6382 48.1882 68.6382 47.5501 67.3707 45.2448C67.2749 45.0708 67.1342 44.9256 66.9632 44.8245C66.7921 44.7233 66.5971 44.67 66.3984 44.6699Z"
        fill="#756B61"
      />
      <path
        d="M59.2031 31.7695C59.056 31.7695 58.9148 31.828 58.8107 31.9321C58.7067 32.0361 58.6482 32.1773 58.6482 32.3245V37.8739C58.6482 38.021 58.7067 38.1622 58.8107 38.2663C58.9148 38.3703 59.056 38.4288 59.2031 38.4288H61.4229C61.8644 38.4288 62.2879 38.6042 62.6001 38.9164C62.9123 39.2286 63.0877 39.6521 63.0877 40.0936V41.7584C63.0877 42.0528 63.2046 42.3351 63.4128 42.5433C63.6209 42.7514 63.9032 42.8683 64.1976 42.8683H67.5272C67.8216 42.8683 68.1039 42.7514 68.312 42.5433C68.5202 42.3351 68.6371 42.0528 68.6371 41.7584V40.0936C68.6371 32.5797 62.04 31.7695 59.2031 31.7695Z"
        fill="#756B61"
      />
      <path
        d="M45.8846 31.7695H42.5549C42.2485 31.7695 42 32.018 42 32.3245V37.8739C42 38.1804 42.2485 38.4288 42.5549 38.4288H45.8846C46.1911 38.4288 46.4395 38.1804 46.4395 37.8739V32.3245C46.4395 32.018 46.1911 31.7695 45.8846 31.7695Z"
        fill="#756B61"
      />
      <path
        d="M55.0488 28.5505C54.967 28.5293 54.8946 28.4815 54.8429 28.4146C54.7913 28.3477 54.7634 28.2654 54.7636 28.1809V28.1621C54.7636 28.0149 54.8221 27.8737 54.9261 27.7696C55.0302 27.6656 55.1714 27.6071 55.3185 27.6071H60.5905C60.8848 27.6071 61.1671 27.4902 61.3753 27.282C61.5834 27.0739 61.7004 26.7916 61.7004 26.4972C61.7004 26.2029 61.5834 25.9206 61.3753 25.7124C61.1671 25.5043 60.8848 25.3874 60.5905 25.3874H55.0411C54.9675 25.3874 54.8969 25.3581 54.8449 25.3061C54.7928 25.254 54.7636 25.1835 54.7636 25.1099C54.7636 24.8155 54.6467 24.5332 54.4385 24.3251C54.2304 24.1169 53.9481 24 53.6537 24H51.434C51.1396 24 50.8573 24.1169 50.6492 24.3251C50.441 24.5332 50.3241 24.8155 50.3241 25.1099C50.3241 25.1835 50.2948 25.254 50.2428 25.3061C50.1908 25.3581 50.1202 25.3874 50.0466 25.3874H44.4972C44.2029 25.3874 43.9205 25.5043 43.7124 25.7124C43.5043 25.9206 43.3873 26.2029 43.3873 26.4972C43.3873 26.7916 43.5043 27.0739 43.7124 27.282C43.9205 27.4902 44.2029 27.6071 44.4972 27.6071H49.7691C49.9163 27.6071 50.0575 27.6656 50.1615 27.7696C50.2656 27.8737 50.3241 28.0149 50.3241 28.1621C50.3239 28.2508 50.2944 28.3369 50.2402 28.4072C50.186 28.4774 50.1102 28.5278 50.0244 28.5505C49.3153 28.7402 48.6886 29.1583 48.2411 29.7402C47.7937 30.322 47.5506 31.0352 47.5494 31.7692V38.4284C47.5494 39.3115 47.9002 40.1584 48.5246 40.7829C49.149 41.4073 49.9959 41.7581 50.879 41.7581H54.2087C55.0917 41.7581 55.9386 41.4073 56.5631 40.7829C57.1875 40.1584 57.5383 39.3115 57.5383 38.4284V31.7692C57.5365 31.0332 57.2913 30.3185 56.8411 29.7364C56.3908 29.1542 55.7607 28.7373 55.0488 28.5505Z"
        fill="#756B61"
      />
    </g>
    <defs>
      <clipPath id="clip0_518_1814">
        <rect
          width="26.6371"
          height="26.6371"
          fill="white"
          transform="translate(42 24)"
        />
      </clipPath>
    </defs>
  </ComponentBase>
</template>

<script setup lang="ts">
import AnimatedNumber from "vue-number-animation";
import { useObservable } from "@vueuse/rxjs";
import ComponentBase from "./ComponentBase.vue";
import { type PowerHubStore } from "@/stores/power-hub";
import { formattedInt } from "@/utils/numbers";

const { powerHub } = defineProps<{ powerHub: PowerHubStore }>();

const value = useObservable(powerHub.sensors.useMean("fresh_water_tank/water_demand"));
</script>
