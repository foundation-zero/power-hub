<template>
  <ComponentBase
    component="water-maker"
    journey="water"
    width="112"
    height="111"
    viewBox="0 0 112 111"
  >
    <rect
      width="112"
      height="111"
      rx="55.5"
      class="fill"
      fill="#86B4E8"
    />
    <circle
      cx="56"
      cy="55"
      r="46"
      fill="white"
    />
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-size="12"
      font-family="Five-Gothic-Bold"
      letter-spacing="0em"
    >
      <tspan
        x="21.3125"
        y="63.96"
      >
        Watermaker
      </tspan>
    </text>
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-family="DMMono"
      font-size="10"
      letter-spacing="0em"
    >
      <AnimatedNumber
        text-anchor="end"
        tag="tspan"
        x="54"
        y="80"
        :to="value"
        :format="formattedInt"
      />
    </text>
    <text
      fill="#756B61"
      xml:space="preserve"
      style="white-space: pre"
      font-size="9"
      letter-spacing="0em"
    >
      <tspan
        x="58"
        y="80"
      >
        l/min
      </tspan>
    </text>
    <path
      d="M54.412 22C56.306 23.6605 58.0365 25.3729 58.7316 27.6244C59.321 29.5349 58.4028 31.3032 56.4031 32.1211C54.8341 32.7632 53.2708 32.6794 51.8364 31.8519C50.3683 31.0053 49.7212 29.8001 49.9029 28.3137C50.0654 26.9775 50.7528 25.8018 51.6748 24.7355C52.4555 23.833 53.3612 23.0048 54.2139 22.1446C54.2582 22.0998 54.3197 22.0671 54.413 22H54.412Z"
      fill="#756B61"
    />
    <path
      d="M54.8492 46.9992C51.2804 46.9712 48.2423 46.6933 45.3071 45.8547C43.9054 45.4545 42.5719 44.9393 41.449 44.1119C40.6558 43.5273 40.0587 42.8412 40.0039 41.9219C39.953 41.0697 40.401 40.3788 41.0865 39.7814C42.0777 38.9172 43.3189 38.3733 44.6457 37.9771C45.6686 37.672 46.7271 37.4484 47.7751 37.2048C48.2135 37.1025 48.5269 37.2383 48.6173 37.5227C48.7096 37.815 48.4904 38.0522 48.0279 38.1384C46.3262 38.4547 44.6601 38.8605 43.1709 39.6384C42.669 39.9004 42.1892 40.2191 41.7883 40.5801C40.9173 41.366 40.9375 42.2342 41.7835 43.0488C42.4969 43.7357 43.4218 44.1742 44.4005 44.5408C46.3647 45.2756 48.4452 45.6454 50.5719 45.8515C53.4696 46.1326 56.3644 46.103 59.2487 45.7333C61.3426 45.4649 63.3885 45.0472 65.246 44.167C65.8421 43.8843 66.4141 43.5296 66.8958 43.1239C67.8957 42.2797 67.8716 41.3412 66.8919 40.4778C65.9546 39.6512 64.7566 39.1672 63.4933 38.8022C62.5906 38.5418 61.6589 38.3509 60.736 38.14C60.4226 38.0682 60.1678 37.9635 60.1457 37.6616C60.1207 37.3182 60.4764 37.089 60.9408 37.1968C62.0916 37.4659 63.2462 37.7311 64.373 38.0594C65.4287 38.3669 66.4035 38.8221 67.2554 39.4371C68.0947 40.0441 68.7225 40.7566 68.7734 41.7222C68.8129 42.4698 68.4485 43.0999 67.8736 43.651C66.9381 44.5472 65.7248 45.1047 64.4317 45.5511C62.2204 46.3147 59.8986 46.6925 57.5248 46.8666C56.475 46.9441 55.4193 46.972 54.8482 46.9992H54.8492Z"
      fill="#756B61"
    />
    <path
      d="M53.5215 43.3543C57.0201 43.3128 59.64 43.2018 62.1925 42.6211C62.7761 42.4886 63.3424 42.2841 63.8885 42.0644C64.2663 41.9127 64.274 41.7258 63.8952 41.5844C63.1905 41.3209 62.4685 41.0589 61.7214 40.9095C60.712 40.7083 59.6698 40.6188 58.6439 40.4694C58.4642 40.4431 58.2325 40.3952 58.1421 40.2889C58.0363 40.1643 57.9758 39.9287 58.0498 39.8065C58.1325 39.6708 58.3997 39.515 58.5699 39.5278C60.4822 39.6732 62.3829 39.88 64.1336 40.5996C64.4182 40.717 64.6893 40.8816 64.9162 41.0677C65.4767 41.5269 65.495 42.1411 64.897 42.5644C64.4778 42.8615 63.9731 43.102 63.4607 43.2753C62.0974 43.7369 60.6466 43.9142 59.1939 44.0564C56.8557 44.2848 54.5098 44.3607 52.1582 44.2401C50.0633 44.1331 47.9722 43.9813 45.9571 43.4582C45.336 43.2968 44.7159 43.0716 44.1756 42.7745C43.1911 42.233 43.2045 41.4215 44.1611 40.8464C45.0649 40.3033 46.1272 40.0741 47.1963 39.8928C48.1106 39.7378 49.0394 39.6452 49.9623 39.5254C50.021 39.5174 50.0816 39.5166 50.1421 39.5158C50.5209 39.5094 50.7699 39.6731 50.7949 39.9447C50.8199 40.2195 50.6094 40.4223 50.2392 40.4663C49.5278 40.5509 48.8038 40.5893 48.1068 40.7234C47.154 40.9063 46.2147 41.1443 45.285 41.3967C45.0341 41.4646 44.838 41.6715 44.6159 41.8153C44.8437 41.9638 45.0476 42.1579 45.3043 42.2529C46.4849 42.689 47.7434 42.9143 49.0173 43.0309C50.8017 43.1946 52.5957 43.2896 53.5234 43.3543H53.5215Z"
      fill="#756B61"
    />
    <path
      d="M54.3975 33.5918C55.6935 34.7443 56.9001 35.904 57.2193 37.4926C57.4212 38.4966 56.9914 39.3296 55.9656 39.8919C54.9397 40.4542 53.8504 40.4542 52.8227 39.8975C51.794 39.34 51.3565 38.5078 51.5623 37.5046C51.6632 37.0134 51.8834 36.5262 52.1439 36.0741C52.6804 35.1413 53.4793 34.3585 54.3975 33.5918Z"
      fill="#756B61"
    />
  </ComponentBase>
</template>

<script setup lang="ts">
import AnimatedNumber from "vue-number-animation";
import { formattedInt } from "@/utils/numbers";
import { useObservable } from "@vueuse/rxjs";
import ComponentBase from "./ComponentBase.vue";
import { type PowerHubStore } from "@/stores/power-hub";

const { powerHub } = defineProps<{ powerHub: PowerHubStore }>();

const value = useObservable(powerHub.sensors.useMean("water_maker/out_flow"));
</script>
